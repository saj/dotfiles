#!/bin/bash

set -e

# The following substitution strips trailing whitespace from any empty
# headers generated by the MUA.  Vim may take this trailing whitespace a
# hint to join lines when surrounding headers are edited.

vim \
  -c 'setlocal ft=mail' \
  -c 'silent! 1,6s/^\(\(From\|To\|Cc\|Bcc\|Reply-To\):\)\([[:space:]]\+\)$/\1/e' \
  -i $HOME/.vim/info/email \
  +/^$ +"normal o" +:start \
  $@
