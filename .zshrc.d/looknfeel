autoload -U add-zsh-hook

# Tab-completion on crack.
autoload -U compinit
compinit

setopt AUTO_LIST
setopt AUTO_PUSHD
setopt EXTENDED_HISTORY
setopt HIST_REDUCE_BLANKS
setopt LIST_PACKED
setopt PUSHD_IGNORE_DUPS
setopt PUSHD_TO_HOME

export HISTFILE=${HOME}/.history
export HISTSIZE=1000
export HISTTIMEFORMAT='%Y-%m-%d %H:%M:%S  '
export HIST_FCNTL_LOCK=1
export HIST_FIND_NO_DUPS=1
export HIST_IGNORE_DUPS=0
export SAVEHIST=1000

autoload -U edit-command-line
zle -N edit-command-line
bindkey -v
bindkey -M vicmd v edit-command-line
bindkey '^r' history-incremental-search-backward

# Fucking Debian - http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=383737
(( ${+terminfo[cuu1]}  )) && bindkey -M viins "$terminfo[cuu1]" up-line-or-history
(( ${+terminfo[kcuu1]} )) && bindkey -M viins "$terminfo[kcuu1]" up-line-or-history
[[ "${terminfo[kcuu1]:-}" == ""* ]] && bindkey -M viins "${terminfo[kcuu1]/O/[}" up-line-or-history

export PROMPT="%n@%m %# "

case "$(uname -s)" in
  Darwin) export CLICOLOR=true ;;
  Linux)  local ls="${ls} --color=auto" ;;
esac

if grep --version 2>&1 | head -1 | grep -q GNU ; then
  local grep="grep --color=auto"
else
  local grep="grep"
fi

# vim:ft=zsh
